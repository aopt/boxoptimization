data <- c(
  156,162,168,178,178,180,185,185,190,192,193,194,195,195,197,197,198,198,199,200,202,206,
  206,210,210,210,212,212,214,215,217,217,217,217,217,218,220,220,220,220,220,220,220,220,
  220,220,222,223,223,224,225,225,225,225,225,225,225,226,226,226,227,228,228,228,228,230,
  230,230,230,230,230,230,230,230,230,230,230,230,232,232,232,233,233,234,234,235,235,235,
  235,238,238,238,238,240,240,240,240,240,240,240,240,240,241,242,242,242,242,243,244,244,
  244,245,246,247,247,247,249,250,250,250,250,250,251,252,252,252,252,253,254,254,254,255,
  255,255,255,255,256,256,257,257,257,258,258,258,258,258,259,260,260,260,260,260,260,260,
  260,260,262,262,262,262,262,262,262,264,264,264,265,265,265,265,265,266,267,267,267,267,
  268,268,268,268,268,268,269,270,270,270,270,270,270,270,270,270,270,271,272,272,272,272,
  272,273,273,273,273,274,274,274,274,274,275,275,275,275,275,275,277,277,277,278,278,278,
  278,278,278,280,280,280,280,281,282,282,284,285,285,285,285,285,285,287,287,287,288,288,
  288,288,288,289,290,290,290,290,290,290,290,290,290,290,290,292,292,293,293,294,294,294,
  295,295,295,295,295,295,295,295,296,296,297,297,298,298,298,298,300,300,300,300,300,300,
  300,300,300,300,300,300,300,300,302,302,303,303,303,303,304,305,305,305,305,305,306,306,
  307,308,308,308,310,310,310,310,310,310,310,312,312,312,312,313,315,315,315,315,315,315,
  315,315,315,317,317,317,317,318,318,318,318,320,320,320,320,320,320,320,320,320,320,320,
  320,320,322,323,323,325,325,325,325,326,326,327,327,328,328,330,330,330,330,330,330,330,
  332,333,333,334,334,334,334,335,335,335,335,335,336,336,336,338,338,339,339,340,340,340,
  340,340,340,340,342,342,342,342,343,345,345,345,345,345,345,345,346,346,346,347,347,348,
  348,348,349,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,352,
  352,353,353,353,353,354,354,354,356,357,357,357,357,358,358,360,360,360,360,360,360,360,
  360,360,360,360,360,361,362,362,362,363,363,364,364,364,364,365,365,365,365,365,365,365,
  367,367,367,368,370,370,370,370,370,370,370,370,370,372,372,372,373,375,375,375,375,375,
  375,377,377,377,378,380,380,380,380,380,380,380,380,380,380,380,380,381,382,383,383,383,
  383,384,384,384,384,385,385,385,386,386,386,386,387,387,387,387,388,388,388,388,388,389,
  390,392,392,393,394,394,395,396,397,397,398,398,398,400,400,400,400,400,400,400,400,405,
  405,408,410,410,410,410,410,410,412,412,412,412,412,413,415,415,416,416,417,417,418,418,
  419,419,419,420,420,420,420,420,420,420,420,423,423,423,423,424,424,425,425,425,428,428,
  430,430,430,430,430,430,430,430,430,430,430,430,431,432,432,432,432,433,433,433,433,433,
  434,434,435,435,435,435,437,438,438,438,438,440,440,440,440,440,440,440,441,442,443,444,
  444,445,445,445,445,445,445,445,445,446,447,448,448,450,450,450,450,450,450,450,450,450,
  452,453,453,455,455,455,455,456,457,458,458,458,458,459,460,460,460,460,460,460,460,462,
  462,463,464,465,465,465,465,465,465,465,466,466,467,467,467,467,467,468,468,468,469,469,
  470,470,470,470,470,470,470,470,470,472,472,472,474,475,475,476,478,478,478,478,480,480,
  480,480,480,480,480,480,480,480,480,480,482,482,482,482,482,482,482,485,485,485,485,488,
  488,488,488,490,490,490,490,490,490,490,490,491,491,492,492,492,492,492,492,492,493,493,
  495,495,495,496,497,498,498,498,498,498,498,498,499,500,500,500,500,500,500,502,502,502,
  505,505,505,505,505,506,507,507,510,510,510,510,510,510,510,510,510,510,510,510,512,512,
  513,514,515,515,517,517,518,520,520,520,520,520,520,522,523,523,523,524,525,525,525,525,
  525,525,528,528,528,528,528,528,528,530,530,530,530,530,530,531,532,534,535,535,535,535,
  535,536,538,538,538,539,540,540,540,540,540,540,540,540,540,540,540,541,543,543,543,544,
  544,545,545,545,546,546,546,547,547,548,548,550,550,550,550,550,550,550,550,550,550,550,
  550,550,552,552,555,555,555,555,555,555,555,557,557,557,557,560,560,560,560,560,562,562,
  563,563,564,565,565,565,565,565,565,567,567,568,568,569,569,569,570,570,570,571,572,572,
  573,574,574,574,576,576,578,580,580,580,584,585,585,587,588,590,592,593,596,597,600,600,
  600,600,602,602,602,602,602,603,604,605,605,605,605,605,605,605,607,607,607,608,610,610,
  610,610,610,610,612,612,612,612,615,615,615,615,618,618,620,622,624,625,625,625,627,627,
  628,628,628,630,630,632,633,635,635,637,638,638,640,640,640,640,640,642,643,647,648,649,
  650,650,655,655,655,656,660,660,660,660,660,662,662,663,664,664,664,664,665,665,665,670,
  670,672,677,677,679,680,680,680,680,680,685,685,687,688,690,690,692,694,695,697,698,700,
  700,701,704,704,705,705,705,705,705,705,705,705,705,710,710,712,715,717,720,720,722,723,
  727,730,733,733,734,734,734,735,735,735,738,740,743,744,754,755,755,755,755,755,758,760,
  766,766,780,780,780,780,780,780,780,782,783,785,795,805,806,820,823,827,827,855,855,864)

# get unique values and counts
t<-table(data)
count <- as.vector(t)
size <- as.numeric(rownames(t))

cumulative <- cumsum(count)

# number of box sizes, number of item sizes
NB <- 4
NI <- length(size)

# allocate matrix NI rows, NB columns (initialize with NAs)
# f[ni,nb] = cost when we have ni items and nb blocks
F <- matrix(NA,NI,NB)
S <- matrix("",NI,NB)

# initialize for nb=1
F[1:NI,1] <- cumulative * size[1:NI]^2
S[1:NI,1] <- paste("(",1,"-",1:NI,")",sep="")

# dyn programming loop
for (nb in 2:NB) {
  for (ni in nb:NI) {
     k <- (nb-1):(ni-1)
     v <- F[k,nb-1] + (cumulative[ni]-cumulative[k])*size[ni]^2
     F[ni,nb] <- min(v)
     
     # create path (string)
     mink <- which.min(v) + nb - 2
     s <- paste("(",mink+1,"-",ni,")",sep="")
     S[ni,nb] <- paste(S[mink,nb-1],s,sep=",")
  }
}

for (nb in 1:NB) {
   cat(sprintf("%s boxes: %s, total area = %g\n",nb,S[NI,nb],F[NI,nb]))
}